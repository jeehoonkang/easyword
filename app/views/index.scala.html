@(articleForm: Form[String])(implicit req: RequestHeader, flash: Flash)

@main("대문") {
  <div class="row-fluid">
    <div class="span2"></div>
    <div class="span8 well">
      @flash.get("success").map { info =>
      <p class="text-success">
        @info
      </p>
      }
      @flash.get("error").map { error =>
      <p class="text-error">
        @error
      </p>
      }
      <p>연구 내용을 쉽게 쓸 수 있는 내공이 있으세요? <a href='@routes.Assets.at("words/words.txt")'>가장 많이 쓰이는 한국어 낱말</a>만 사용해서 글을 써봐요.</p>
      @helper.form(routes.Board.create) {
      <textarea id="text" name="text" rows="10" style="width: 95%; resize: none">어려운 말을 쓰면 이렇게 밑줄이 생겨요.</textarea>
      <p><button id="submit" class="btn btn-primary">쓰기</button>&nbsp;<span id="message"></span></p>
      <input id="count" style="display: none"></input>
      }
    </div>
    <div class="span2"></div>
  </div>

  <div class="row-fluid">
    <div class="span2"></div>
    <ul ng-controller="ArticleCtrl" class="unstyled span8">
      <li ng-repeat="article in articles" class="well">
        <p><strong><a href="mailto:{{article.authorEmail}}">{{article.authorName}}</a></strong></p>
        <p>{{article.content}}</p>
        <p style="font-size: 13px">
          <a href="" ng-click="like(article)" style="{{article.likeStyle}}">좋아요</a>
          <a href="" ng-click="unlike(article)" style="{{article.unlikeStyle}}">좋아요 취소</a>
          <a href="" ng-click="getComments(article)" style="{{article.getCommentsStyle}}">댓글 {{article.numComments}}개 보기</a>
        </p>
        <p style="font-size: 13px">{{article.numLikes}}명이 좋아합니다.</p>
        <p style="font-size: 13px">
          <div class="comments">
            <ul>
              <li ng-repeat="comment in article.comments">
                <p>
                  <strong><a href="mailto:{{comment.authorEmail}}">{{comment.authorName}}</a></strong>
                  {{comment.content}}
                </p>
              </li>
              </li>
            </ul>
          </div>
          <textarea ng-model="article.newComment" ng-keypress="createComment($event, article)" rows="3" style="font-size: 13px; width: 95%; resize: none"></textarea>
        </p>
      </li>
    </ul>
    <div class="span2"></div>
  </div>

  <script type="text/javascript" src='@routes.Assets.at("js/article.js")'></script>
  <!-- <script type="text/javascript"> -->
  <!--   var articles = $("#articles") -->
  <!--   articles.find(".article").each(function(index, article) { -->
  <!--     var articleId = article.id -->
  <!--     var article = $(article) -->
  <!--     var likeBtnTag = article.find("a.likeBtn") -->
  <!--     var unlikeBtnTag = article.find("a.unlikeBtn") -->
  <!--     var commentsBtnTag = article.find("a.commentsBtn") -->
  <!--     var commentsTag = article.find("div.comments") -->

  <!--     likeBtnTag.click(function() { -->
  <!--       likeTag.attr('style', 'display: none') -->
  <!--       unlikeTag.attr('style', '') -->
  <!--       $.post('@routes.Board.like("")' + articleId) -->
  <!--       return false -->
  <!--     }) -->
  <!--     unlikeBtnTag.click(function() { -->
  <!--       unlikeTag.attr('style', 'display: none') -->
  <!--       likeTag.attr('style', '') -->
  <!--       $.post('@routes.Board.unlike("")' + articleId) -->
  <!--       return false -->
  <!--     }) -->
  <!--     commentsBtnTag.click(function() { -->
  <!--       commentsBtnTag.remove() -->

  <!--       commentsTag.attr('style', '') -->
  <!--       $.get('@routes.Board.comments("")' + articleId, function(data) { -->
  <!--         console.log(data) -->
  <!--       }) -->

  <!--       return false -->
  <!--     }) -->
  <!--   }) -->
  <!-- </script> -->

  <script type="text/javascript" src='@routes.Assets.at("phpspellcheck/include.js")'></script>
  <script type="text/javascript">
    var mySpell = new LiveSpellInstance()
    mySpell.Fields = "text"
    mySpell.CaseSensitive = false
    mySpell.IgnoreAllCaps = false
    mySpell.IgnoreNumeric = false
    mySpell.CheckGrammar = false
    mySpell.ShowMeanings = false
    mySpell.ShowSummaryScreen = false
    mySpell.ActivateAsYouType()
  </script>

  <script type="text/javascript">
    var textTag = $('#text');
    var countTag = $('#count');
    
    function enableButton() {
      if ((textTag.val() != "" && textTag.val() != "\n") && countTag.val() == "0") {
        $('#submit').removeAttr('disabled');
      } else {
        $('#submit').attr('disabled', 'disabled');
      }
    };

    textTag.bind('blur keyup', function() {
      enableButton();
    });

    enableButton();
  </script>
}
